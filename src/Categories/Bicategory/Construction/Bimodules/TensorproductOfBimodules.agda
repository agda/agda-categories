{-# OPTIONS --without-K --safe --lossy-unification #-}

open import Categories.Bicategory
open import Categories.Bicategory.LocalCoequalizers
open import Categories.Bicategory.Monad
open import Categories.Bicategory.Monad.Bimodule

module Categories.Bicategory.Construction.Bimodules.TensorproductOfBimodules
  {o โ e t} {๐ : Bicategory o โ e t} {localCoeq : LocalCoequalizers ๐}
  {Mโ Mโ Mโ : Monad ๐} (Bโ : Bimodule Mโ Mโ) (Bโ : Bimodule Mโ Mโ) where

open import Level
import Categories.Bicategory.Extras as Bicat
open Bicat ๐
open Shorthands
open import Categories.Category

open LocalCoequalizers localCoeq
open ComposeWithLocalCoequalizer ๐ localCoeq using (_coeq-โ_; _โท-coeq_)

open Monad using (C; T; ฮผ; ฮท)
open Bimodule using (F; actionหก; actionสณ; assoc; sym-assoc; assoc-actionหก; assoc-actionสณ; identityหก; identityสณ)

open import Categories.Diagram.Coequalizer (hom (C Mโ) (C Mโ)) using (Coequalizer; CoequalizerโEpi)
open import Categories.Diagram.Coequalizer.Properties (hom (C Mโ) (C Mโ)) using (โMapBetweenCoeq; โMapBetweenCoeqSq)
import Categories.Category
open Categories.Category.Definitions (hom (C Mโ) (C Mโ)) using (CommutativeSquare)

import Categories.Morphism.Reasoning (hom (C Mโ) (C Mโ)) as MorphismReasoning
import Categories.Morphism.Reasoning.Iso (hom (C Mโ) (C Mโ)) as IsoReasoning

{-
To construct the tensorproduct BโโBโ we will define its underlying 1-cell
to be the coequalizer of the following parallel pair in hom (C Mโ) (C Mโ):

                      act-to-the-left
  F Bโ โ T Mโ โ F Bโ ==================> F Bโ โ F Bโ
                      act-to-the-right
-}

-- We itroduce names to the two parallel morphism in the above diagram --
act-to-the-left act-to-the-right : F Bโ โโ T Mโ โโ F Bโ   โโ   F Bโ โโ F Bโ
act-to-the-left = F Bโ โท actionสณ Bโ
act-to-the-right = actionหก Bโ โ F Bโ โแตฅ ฮฑโ

abstract
  -- to costruct the tensorproduct of bimodules the following coequalizer is formed --
  -- to speed-up type-checking we hide the definition of this coequalizer under an abstract clause --
  -- for all foreseeable purposes, the particular choice of coequalizer will not matter --
  CoeqBimods : Coequalizer        act-to-the-left act-to-the-right
  CoeqBimods = local-coequalizers act-to-the-left act-to-the-right
  
-- The underlying object of that coequalizer is the underlying 1-cell of the bimodule BโโBโ --
F-โ : C Mโ โโ C Mโ
F-โ = Coequalizer.obj CoeqBimods


module Left-Action where

  {-
                                 act-to-the-left โ T Mโ
    (F Bโ โ T Mโ โ F Bโ) โ T Mโ ========================> (F Bโ โ F Bโ) โ T Mโ ---> F โ T Mโ      ::     CoeqBimods coeq-โ T Mโ
             |                   act-to-the-right โ T Mโ            |                  .
             |                                                      |                  .
         actionหก-โ-โ                                             actionหก-โ          actionหก-โ
             |                                                      |                  .
             v                      act-to-the-left                 v                  v
    F Bโ โ T Mโ โ F Bโ ======================================> F Bโ โ F Bโ ----------> F          ::     CoeqBimods
                                    act-to-the-right
  -}

  actionหก-โ-โ : (F Bโ โโ T Mโ โโ F Bโ) โโ T Mโ   โโ   F Bโ โโ T Mโ โโ F Bโ
  actionหก-โ-โ = ฮฑโ โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ โแตฅ ฮฑโ  โแตฅ ฮฑโ โ T Mโ

  actionหก-โ : (F Bโ โโ F Bโ) โโ T Mโ โโ  F Bโ โโ F Bโ
  actionหก-โ = F Bโ โท actionหก Bโ โแตฅ ฮฑโ

  abstract
    private
      sq-act-to-the-left : CommutativeSquare
                             actionหก-โ-โ
                             (act-to-the-left โ T Mโ)
                             act-to-the-left
                             actionหก-โ
      sq-act-to-the-left = begin
        act-to-the-left โแตฅ actionหก-โ-โ                                                                 โโจ reflโฉโโจ โบ assocโ โฉ
        F Bโ โท actionสณ Bโ โแตฅ (ฮฑโ โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ) โแตฅ ฮฑโ  โแตฅ ฮฑโ โ T Mโ                   โโจ reflโฉโโจ ฮฑโ-โท-โโ โฉโโจrefl โฉ
        F Bโ โท actionสณ Bโ โแตฅ (F Bโ โท T Mโ โท actionหก Bโ โแตฅ ฮฑโ) โแตฅ ฮฑโ  โแตฅ ฮฑโ โ T Mโ                      โโจ reflโฉโโจ assocโ โฉ
        F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ  โแตฅ ฮฑโ โ T Mโ                        โโจ โบ assocโ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ ฮฑโ โแตฅ ฮฑโ  โแตฅ ฮฑโ โ T Mโ                      โโจ reflโฉโโจ โบ assocโ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ (ฮฑโ โแตฅ ฮฑโ) โแตฅ ฮฑโ โ T Mโ                     โโจ reflโฉโโจ โบ pentagon โฉโโจrefl โฉ
        -- maybe this can be shortened using conjugate --
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ (F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ) โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ assocโ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ (ฮฑโ โแตฅ ฮฑโ โ T Mโ) โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ reflโฉโโจ assocโ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โแตฅ ฮฑโ โ T Mโ   โโจ reflโฉโโจ reflโฉโโจ reflโฉโโจ โแตฅ-distr-โ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ (ฮฑโ โแตฅ ฮฑโ) โ T Mโ        โโจ reflโฉโโจ reflโฉโโจ reflโฉโโจ โ-resp-โ associator.isoสณ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ idโ โ T Mโ               โโจ reflโฉโโจ reflโฉโโจ reflโฉโโจ idโโ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ idโ                      โโจ reflโฉโโจ reflโฉโโจ identityโสณ โฉ
        (F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ                             โโจ โบ assocโ โฉ
        ((F Bโ โท actionสณ Bโ โแตฅ F Bโ โท T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ) โแตฅ ฮฑโ                           โโจ โแตฅ-distr-โท โฉโโจrefl โฉโโจrefl โฉ
        (F Bโ โท (actionสณ Bโ โแตฅ T Mโ โท actionหก Bโ) โแตฅ F Bโ โท ฮฑโ) โแตฅ ฮฑโ                                  โโจ โแตฅ-distr-โท โฉโโจrefl โฉ
        F Bโ โท ((actionสณ Bโ โแตฅ T Mโ โท actionหก Bโ) โแตฅ ฮฑโ) โแตฅ ฮฑโ                                         โโจ โท-resp-โ assocโ โฉโโจrefl โฉ
        F Bโ โท (actionสณ Bโ โแตฅ T Mโ โท actionหก Bโ โแตฅ ฮฑโ) โแตฅ ฮฑโ                                           โโจ โท-resp-โ (assoc Bโ) โฉโโจrefl โฉ
        F Bโ โท (actionหก Bโ โแตฅ actionสณ Bโ โ T Mโ) โแตฅ ฮฑโ                                                 โโจ โบ โแตฅ-distr-โท โฉโโจrefl โฉ
        (F Bโ โท actionหก Bโ โแตฅ F Bโ โท (actionสณ Bโ โ T Mโ)) โแตฅ ฮฑโ                                        โโจ assocโ โฉ
        F Bโ โท actionหก Bโ โแตฅ F Bโ โท (actionสณ Bโ โ T Mโ) โแตฅ ฮฑโ                                          โโจ reflโฉโโจ โบ ฮฑโ-โท-โ โฉ
        F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ (F Bโ โท actionสณ Bโ) โ T Mโ                                          โโจ โบ assocโ โฉ
        actionหก-โ โแตฅ (act-to-the-left) โ T Mโ                                                          โ
        where
          open hom.HomReasoning

      sq-act-to-the-right : CommutativeSquare
                              actionหก-โ-โ
                              (act-to-the-right โ T Mโ)
                              act-to-the-right
                              actionหก-โ
      sq-act-to-the-right = begin
        act-to-the-right โแตฅ actionหก-โ-โ                                                     โโจ โบ assocโ โฉ
        ((actionหก Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ ฮฑโ) โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ assocโ โฉโโจrefl โฉ
        (actionหก Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ) โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ   โโจ (reflโฉโโจ associator.isoหก) โฉโโจrefl โฉ
        (actionหก Bโ โ F Bโ โแตฅ idโ) โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ        โโจ identityโสณ โฉโโจrefl โฉ
        actionหก Bโ โ F Bโ โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ                 โโจ โบ assocโ โฉ
        (actionหก Bโ โ F Bโ โแตฅ (F Bโ โโ T Mโ) โท actionหก Bโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ               โโจ โบ โ-โท-exchg โฉโโจrefl โฉ
        (F Bโ โท actionหก Bโ โแตฅ actionหก Bโ โ (F Bโ โโ T Mโ)) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ               โโจ assocโ โฉ
        F Bโ โท actionหก Bโ โแตฅ actionหก Bโ โ (F Bโ โโ T Mโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ                 โโจ reflโฉโโจ โบ assocโ โฉ
        F Bโ โท actionหก Bโ โแตฅ (actionหก Bโ โ (F Bโ โโ T Mโ) โแตฅ ฮฑโ) โแตฅ ฮฑโ โ T Mโ               โโจ reflโฉโโจ โบ ฮฑโ-โ-โโ โฉโโจrefl โฉ
        F Bโ โท actionหก Bโ โแตฅ (ฮฑโ โแตฅ actionหก Bโ โ F Bโ โ T Mโ) โแตฅ ฮฑโ โ T Mโ                  โโจ reflโฉโโจ assocโ โฉ
        F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ actionหก Bโ โ F Bโ โ T Mโ โแตฅ ฮฑโ โ T Mโ                    โโจ โบ assocโ โฉ
        actionหก-โ โแตฅ actionหก Bโ โ F Bโ โ T Mโ โแตฅ ฮฑโ โ T Mโ                                  โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
        actionหก-โ โแตฅ act-to-the-right โ T Mโ                                                โ
        where
          open hom.HomReasoning
  -- end abstract --

  abstract    
    -- left-action --
    -- to speed-up type-checking we hide the definition of the left-action under an abstract clause --
    -- probably, no one ever wants to look into its defintion and instead only use the lemma actionหกSq-โ below --
    actionหก-โ : F-โ โโ T Mโ โโ F-โ
    actionหก-โ = โMapBetweenCoeq
                  actionหก-โ-โ
                  actionหก-โ
                  sq-act-to-the-left
                  sq-act-to-the-right
                  (CoeqBimods coeq-โ T Mโ)
                  CoeqBimods

    -- the left-action fits into the following commutative square --
    actionหกSq-โ : CommutativeSquare
                    actionหก-โ
                    (Coequalizer.arr (CoeqBimods coeq-โ T Mโ))
                    (Coequalizer.arr CoeqBimods)
                    actionหก-โ
    actionหกSq-โ = โMapBetweenCoeqSq
                    actionหก-โ-โ
                    actionหก-โ
                    sq-act-to-the-left
                    sq-act-to-the-right
                    (CoeqBimods coeq-โ T Mโ)
                    CoeqBimods
  -- end abstract --

module Right-Action where

  {-
                                 T Mโ โท act-to-the-left
    T Mโ โ (F Bโ โ T Mโ โ F Bโ) ========================> T Mโ โ (F Bโ โ F Bโ) ---> T Mโ โ F      ::     T Mโ โท-coeq CoeqBimods
             |                   T Mโ โท act-to-the-right            |                  .
             |                                                      |                  .
         actionสณ-โ-โ                                             actionสณ-โ          actionสณ-โ
             |                                                      |                  .
             v                      act-to-the-left                 v                  v
    F Bโ โ T Mโ โ F Bโ ======================================> F Bโ โ F Bโ ----------> F          ::     CoeqBimods
                                    act-to-the-right
  -}

  -- to define a map between the coequalizers T Mโ โโ F-โ โโ F-โ we define a map of diagrams --
  actionสณ-โ-โ : T Mโ โโ F Bโ โโ T Mโ โโ F Bโ โโ  F Bโ โโ T Mโ โโ F Bโ
  actionสณ-โ-โ = actionสณ Bโ โ (T Mโ โโ F Bโ) โแตฅ ฮฑโ

  actionสณ-โ : T Mโ โโ F Bโ โโ F Bโ โโ  F Bโ โโ F Bโ
  actionสณ-โ = actionสณ Bโ โ F Bโ โแตฅ ฮฑโ

  -- to get a map of diagrams two squares have to commute --
  abstract
    private
      sq-act-to-the-left : CommutativeSquare
                             actionสณ-โ-โ
                             (T Mโ โท act-to-the-left)
                             act-to-the-left
                             actionสณ-โ
      sq-act-to-the-left = glueโฒ sq-bottom sq-top
        where
          open hom.HomReasoning
          open MorphismReasoning using (glueโฒ)
          sq-top : CommutativeSquare
                     ฮฑโ
                     (T Mโ โท F Bโ โท actionสณ Bโ)
                     ((T Mโ โโ F Bโ) โท actionสณ Bโ)
                     ฮฑโ
          sq-top = โบ ฮฑโ-โท-โโ
          sq-bottom : CommutativeSquare
                        (actionสณ Bโ โ (T Mโ โโ F Bโ))
                        ((T Mโ โโ F Bโ) โท actionสณ Bโ)
                        (F Bโ โท actionสณ Bโ)
                        (actionสณ Bโ โ F Bโ)
          sq-bottom = โ-โท-exchg

      sq-act-to-the-right : CommutativeSquare
                              actionสณ-โ-โ
                              (T Mโ โท (act-to-the-right))
                              act-to-the-right
                              actionสณ-โ
      sq-act-to-the-right = begin
        act-to-the-right โแตฅ actionสณ-โ-โ                                                    โโจ โบ assocโ โฉ
        ((actionหก Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ actionสณ Bโ โ  (T Mโ โโ F Bโ)) โแตฅ ฮฑโ                  โโจ assocโ โฉโโจrefl โฉ
        (actionหก Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ actionสณ Bโ โ  (T Mโ โโ F Bโ))) โแตฅ ฮฑโ                  โโจ (reflโฉโโจ ฮฑโ-โ-โโ) โฉโโจrefl โฉ
        (actionหก Bโ โ F Bโ โแตฅ (actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ)) โแตฅ ฮฑโ                      โโจ assocโ โฉ
        actionหก Bโ โ F Bโ โแตฅ ((actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ) โแตฅ ฮฑโ)                      โโจ reflโฉโโจ assocโ โฉ
        actionหก Bโ โ F Bโ โแตฅ actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ                          โโจ reflโฉโโจ reflโฉโโจ โบ pentagon-inv โฉ
        actionหก Bโ โ F Bโ โแตฅ actionสณ Bโ โ T Mโ โ F Bโ โแตฅ (ฮฑโ โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ    โโจ reflโฉโโจ โบ assocโ โฉ
        actionหก Bโ โ F Bโ โแตฅ (actionสณ Bโ โ T Mโ โ F Bโ โแตฅ (ฮฑโ โ F Bโ โแตฅ ฮฑโ)) โแตฅ T Mโ โท ฮฑโ  โโจ reflโฉโโจ โบ assocโ โฉโโจrefl โฉ
        actionหก Bโ โ F Bโ โแตฅ ((actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ โ F Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ  โโจ โบ assocโ โฉ
        (actionหก Bโ โ F Bโ โแตฅ (actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ โ F Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ  โโจ โบ assocโ โฉโโจrefl โฉ
        ((actionหก Bโ โ F Bโ โแตฅ actionสณ Bโ โ T Mโ โ F Bโ โแตฅ ฮฑโ โ F Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ  โโจ ((reflโฉโโจ โแตฅ-distr-โ) โฉโโจrefl) โฉโโจrefl โฉ
        ((actionหก Bโ โ F Bโ โแตฅ (actionสณ Bโ โ T Mโ โแตฅ ฮฑโ) โ F Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ       โโจ โแตฅ-distr-โ โฉโโจrefl โฉโโจrefl โฉ
        ((actionหก Bโ โแตฅ actionสณ Bโ โ T Mโ โแตฅ ฮฑโ) โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ                โโจ โ-resp-โ (sym-assoc Bโ) โฉโโจrefl โฉโโจrefl โฉ
        ((actionสณ Bโ โแตฅ (T Mโ โท actionหก Bโ)) โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ                    โโจ โบ โแตฅ-distr-โ โฉโโจrefl โฉโโจrefl โฉ
        ((actionสณ Bโ โ F Bโ โแตฅ (T Mโ โท actionหก Bโ) โ F Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ             โโจ (assocโ โฉโโจrefl) โฉ
        (actionสณ Bโ โ F Bโ โแตฅ (T Mโ โท actionหก Bโ) โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ               โโจ (reflโฉโโจ โบ ฮฑโ-โท-โ) โฉโโจrefl โฉ
        (actionสณ Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท (actionหก Bโ โ F Bโ)) โแตฅ T Mโ โท ฮฑโ               โโจ โบ assocโ โฉโโจrefl โฉ
        ((actionสณ Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท (actionหก Bโ โ F Bโ)) โแตฅ T Mโ โท ฮฑโ             โโจ assocโ โฉ
        (actionสณ Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท (actionหก Bโ โ F Bโ) โแตฅ T Mโ โท ฮฑโ               โโจ reflโฉโโจ โแตฅ-distr-โท โฉ
        actionสณ-โ โแตฅ T Mโ โท act-to-the-right                                               โ
          where
            open hom.HomReasoning
  -- end abstract --

  abstract
    -- right-action --
    -- to speed-up type-checking we hide the definition of the right-action under an abstract clause --
    -- probably, no one ever wants to look into its defintion and instead only use the lemma actionสณSq-โ below --
    actionสณ-โ : T Mโ โโ F-โ โโ F-โ
    actionสณ-โ = โMapBetweenCoeq
                  actionสณ-โ-โ
                  actionสณ-โ
                  sq-act-to-the-left
                  sq-act-to-the-right
                  (T Mโ โท-coeq CoeqBimods)
                  CoeqBimods

    -- the right-action fits into the following commutaitve square --
    actionสณSq-โ : CommutativeSquare (actionสณ-โ) (Coequalizer.arr (T Mโ โท-coeq CoeqBimods)) (Coequalizer.arr CoeqBimods) (actionสณ-โ)
    actionสณSq-โ = โMapBetweenCoeqSq
                    actionสณ-โ-โ
                    actionสณ-โ
                    sq-act-to-the-left
                    sq-act-to-the-right
                    (T Mโ โท-coeq CoeqBimods)
                    CoeqBimods
  -- end abstract --


-- Associativity and identity laws for bimodules each assert an equality of 2-cells.  --
-- To prove that the tensorproduct satisfies these equalities (assoc-โ, sym-assoc-โ, identityหก-โ ,...) --
-- we show that the morphisms precomposed by a coequalizer arrow are equal (assoc-โ-โarr, sym-assoc-โ-โarr, identityหก-โ-โarr,...). --
-- Finally, we use that coequalizer arrows are epis to cancell them --
-- In the proofs of assoc-โ-โarr, sym-assoc-โ-โarr, etc we use that a version of the associativity and identity laws hold for F Bโ โโ F Bโ. --
-- Note that F Bโ โโ F Bโ is a bimodule under actionหก-โ and actionหก-โ (although we don't use that fact). --

module Associativity where
  open Left-Action using (actionหก-โ; actionหกSq-โ; actionหก-โ)
  open Right-Action using (actionสณ-โ; actionสณSq-โ; actionสณ-โ)

  abstract
    assoc-โ : actionสณ-โ โแตฅ T Mโ โท actionหก-โ โแตฅ ฮฑโ โ actionหก-โ โแตฅ actionสณ-โ โ T Mโ
    assoc-โ = begin
      actionสณ-โ โแตฅ T Mโ โท actionหก-โ โแตฅ ฮฑโ                                           โโจ reflโฉโโจ โบ โแตฅ-distr-โท โฉโโจrefl โฉ
      actionสณ-โ โแตฅ (T Mโ โท F Bโ โท actionหก Bโ โแตฅ T Mโ โท ฮฑโ) โแตฅ ฮฑโ                    โโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ (T Mโ โท F Bโ โท actionหก Bโ โแตฅ T Mโ โท ฮฑโ) โแตฅ ฮฑโ      โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ (T Mโ โท F Bโ โท actionหก Bโ โแตฅ T Mโ โท ฮฑโ)) โแตฅ ฮฑโ    โโจ reflโฉโโจ โบ assocโ โฉโโจrefl โฉ
      actionสณ Bโ โ F Bโ โแตฅ ((ฮฑโ โแตฅ T Mโ โท F Bโ โท actionหก Bโ) โแตฅ T Mโ โท ฮฑโ) โแตฅ ฮฑโ    โโจ reflโฉโโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ T Mโ โท F Bโ โท actionหก Bโ) โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ      โโจ reflโฉโโจ ฮฑโ-โท-โโ โฉโโจrefl โฉ
      actionสณ Bโ โ F Bโ โแตฅ ((T Mโ โโ F Bโ) โท actionหก Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ   โโจ โบ assocโ โฉ
      (actionสณ Bโ โ F Bโ โแตฅ ((T Mโ โโ F Bโ) โท actionหก Bโ โแตฅ ฮฑโ)) โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ โโจ โบ assocโ โฉโโจrefl โฉ
      ((actionสณ Bโ โ F Bโ โแตฅ (T Mโ โโ F Bโ) โท actionหก Bโ) โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ โโจ assocโ โฉ
      (actionสณ Bโ โ F Bโ โแตฅ (T Mโ โโ F Bโ) โท actionหก Bโ) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ   โโจ โบ โ-โท-exchg โฉโโจrefl โฉ
      (F Bโ โท actionหก Bโ โแตฅ actionสณ Bโ โ (F Bโ โโ T Mโ)) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โแตฅ ฮฑโ   โโจ reflโฉโโจ pentagon-conjugateโ โฉ
      (F Bโ โท actionหก Bโ โแตฅ actionสณ Bโ โ (F Bโ โโ T Mโ)) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ         โโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ actionสณ Bโ โ (F Bโ โโ T Mโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ           โโจ reflโฉโโจ โบ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ (actionสณ Bโ โ (F Bโ โโ T Mโ) โแตฅ ฮฑโ) โแตฅ ฮฑโ โ T Mโ         โโจ reflโฉโโจ โบ ฮฑโ-โ-โโ โฉโโจrefl โฉ
      F Bโ โท actionหก Bโ โแตฅ (ฮฑโ โแตฅ actionสณ Bโ โ F Bโ โ T Mโ) โแตฅ ฮฑโ โ T Mโ            โโจ reflโฉโโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ actionสณ Bโ โ F Bโ โ T Mโ โแตฅ ฮฑโ โ T Mโ              โโจ โบ assocโ โฉ
      (F Bโ โท actionหก Bโ โแตฅ ฮฑโ) โแตฅ actionสณ Bโ โ F Bโ โ T Mโ โแตฅ ฮฑโ โ T Mโ            โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ actionสณ-โ โ T Mโ                                                 โ
      where
        open hom.HomReasoning

  abstract
    assoc-โ-โarr : (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ ฮฑโ) โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ))
                 โ (actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)) โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ))
    assoc-โ-โarr = begin
      (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ ฮฑโ) โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ)) โโจ โบ assocโ โฉโโจrefl โฉ
      ((actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ ฮฑโ) โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ)) โโจ assocโ โฉ
      (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ ฮฑโ โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ)) โโจ reflโฉโโจ ฮฑโ-โท-โ โฉ
      (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ Coequalizer.arr (T Mโ โท-coeq (CoeqBimods coeq-โ T Mโ)) โแตฅ ฮฑโ  โโจ โบ assocโ โฉ
      ((actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ Coequalizer.arr (T Mโ โท-coeq (CoeqBimods coeq-โ T Mโ))) โแตฅ ฮฑโ  โโจ assocโ โฉโโจrefl โฉ
      (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (CoeqBimods coeq-โ T Mโ))) โแตฅ ฮฑโ  โโจ (reflโฉโโจ โแตฅ-distr-โท) โฉโโจrefl โฉ
      (actionสณ-โ โแตฅ T Mโ โท (actionหก-โ โแตฅ Coequalizer.arr (CoeqBimods coeq-โ T Mโ))) โแตฅ ฮฑโ  โโจ (reflโฉโโจ โท-resp-โ (โบ actionหกSq-โ)) โฉโโจrefl โฉ
      (actionสณ-โ โแตฅ T Mโ โท (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ)) โแตฅ ฮฑโ  โโจ (reflโฉโโจ(โบ โแตฅ-distr-โท)) โฉโโจrefl โฉ
      (actionสณ-โ โแตฅ Coequalizer.arr (T Mโ โท-coeq CoeqBimods) โแตฅ T Mโ โท actionหก-โ) โแตฅ ฮฑโ  โโจ โบ assocโ โฉโโจrefl โฉ
      ((actionสณ-โ โแตฅ Coequalizer.arr (T Mโ โท-coeq CoeqBimods)) โแตฅ T Mโ โท actionหก-โ) โแตฅ ฮฑโ  โโจ (โบ actionสณSq-โ) โฉโโจrefl โฉโโจrefl โฉ
      ((Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โแตฅ T Mโ โท actionหก-โ) โแตฅ ฮฑโ  โโจ assocโ โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โแตฅ T Mโ โท actionหก-โ โแตฅ ฮฑโ  โโจ assocโ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ โแตฅ T Mโ โท actionหก-โ โแตฅ ฮฑโ  โโจ reflโฉโโจ assoc-โ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionหก-โ โแตฅ actionสณ-โ โ T Mโ  โโจ โบ assocโ โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ) โแตฅ actionสณ-โ โ T Mโ  โโจ actionหกSq-โ โฉโโจrefl โฉ
      (actionหก-โ โแตฅ Coequalizer.arr (CoeqBimods coeq-โ T Mโ)) โแตฅ actionสณ-โ โ T Mโ  โโจ assocโ โฉ
      actionหก-โ โแตฅ Coequalizer.arr (CoeqBimods coeq-โ T Mโ) โแตฅ actionสณ-โ โ T Mโ  โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โ T Mโ โโจ reflโฉโโจ โ-resp-โ actionสณSq-โ โฉ
      actionหก-โ โแตฅ (actionสณ-โ โแตฅ Coequalizer.arr (T Mโ โท-coeq CoeqBimods)) โ T Mโ โโจ reflโฉโโจ โบ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ actionสณ-โ โ T Mโ โแตฅ Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ) โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)) โแตฅ (Coequalizer.arr ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ)) โ
      where
        open hom.HomReasoning

  abstract
    assoc-โ : actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ ฮฑโ โ actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)
    assoc-โ = CoequalizerโEpi
                ((T Mโ โท-coeq CoeqBimods) coeq-โ T Mโ)
                (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ ฮฑโ)
                (actionหก-โ โแตฅ (actionสณ-โ โ T Mโ))
                assoc-โ-โarr

  abstract
    assoc-โ-var : (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ ฮฑโ โ actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)
    assoc-โ-var = begin
      (actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)) โแตฅ ฮฑโ โโจ assocโ โฉ
      actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โแตฅ ฮฑโ   โโจ assoc-โ โฉ
      actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)                      โ
      where
        open hom.HomReasoning

  abstract
    sym-assoc-โ : actionหก-โ โแตฅ (actionสณ-โ โ T Mโ) โแตฅ ฮฑโ โ actionสณ-โ โแตฅ (T Mโ โท actionหก-โ)
    sym-assoc-โ = begin
      actionหก-โ โแตฅ (actionสณ-โ โ T Mโ) โแตฅ ฮฑโ โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ (actionสณ-โ โ T Mโ)) โแตฅ ฮฑโ โโจ โบ (switch-fromtoสณ associator assoc-โ-var) โฉ
      actionสณ-โ โแตฅ (T Mโ โท actionหก-โ) โ
      where
        open hom.HomReasoning
        open IsoReasoning using (switch-fromtoสณ)

  abstract
    assoc-actionหก-โ : actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โ actionหก-โ โแตฅ actionหก-โ โ T Mโ
    assoc-actionหก-โ = begin
      actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ (ฮฑโ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ) โแตฅ ฮฑโ โโจ reflโฉโโจ ฮฑโ-โท-โโ โฉโโจrefl โฉ
      F Bโ โท actionหก Bโ โแตฅ (F Bโ โท F Bโ โท ฮผ Mโ โแตฅ ฮฑโ) โแตฅ ฮฑโ โโจ reflโฉโโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮผ Mโ โแตฅ ฮฑโ โแตฅ ฮฑโ โโจ reflโฉโโจ reflโฉโโจ โบ pentagon โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮผ Mโ โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ โบ assocโ โฉ
      (F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮผ Mโ) โแตฅ F Bโ โท ฮฑโ โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ โบ assocโ โฉ
      ((F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮผ Mโ) โแตฅ F Bโ โท ฮฑโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ assocโ โฉโโจrefl โฉ
      (F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮผ Mโ โแตฅ F Bโ โท ฮฑโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ (reflโฉโโจ โแตฅ-distr-โท) โฉโโจrefl โฉ
      (F Bโ โท actionหก Bโ โแตฅ F Bโ โท (F Bโ โท ฮผ Mโ โแตฅ ฮฑโ)) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ โแตฅ-distr-โท โฉโโจrefl โฉ
      F Bโ โท (actionหก Bโ โแตฅ F Bโ โท ฮผ Mโ โแตฅ ฮฑโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ โท-resp-โ (assoc-actionหก Bโ) โฉโโจrefl โฉ
      F Bโ โท (actionหก Bโ โแตฅ actionหก Bโ โ T Mโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ โบ โแตฅ-distr-โท โฉโโจrefl โฉ
      (F Bโ โท actionหก Bโ โแตฅ F Bโ โท (actionหก Bโ โ T Mโ)) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท (actionหก Bโ โ T Mโ) โแตฅ ฮฑโ โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ โบ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ (F Bโ โท (actionหก Bโ โ T Mโ) โแตฅ ฮฑโ) โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ โบ ฮฑโ-โท-โ โฉโโจrefl โฉ
      F Bโ โท actionหก Bโ โแตฅ (ฮฑโ โแตฅ (F Bโ โท actionหก Bโ) โ T Mโ) โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ (F Bโ โท actionหก Bโ) โ T Mโ โแตฅ ฮฑโ โ T Mโ โโจ โบ assocโ โฉ
      (F Bโ โท actionหก Bโ โแตฅ ฮฑโ) โแตฅ (F Bโ โท actionหก Bโ) โ T Mโ โแตฅ ฮฑโ โ T Mโ โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ actionหก-โ โ T Mโ โ
      where
        open hom.HomReasoning

  abstract
    assoc-actionหก-โ-โarr : (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ ฮฑโ) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ)
                         โ (actionหก-โ โแตฅ (actionหก-โ โ T Mโ)) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ)
    assoc-actionหก-โ-โarr = begin
      (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ ฮฑโ) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ) โโจ โบ assocโ โฉโโจrefl โฉ
      ((actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)) โแตฅ ฮฑโ) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ) โโจ assocโ โฉ
      (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)) โแตฅ ฮฑโ โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ) โโจ reflโฉโโจ ฮฑโ-โ-โโ โฉ
      (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)) โแตฅ Coequalizer.arr CoeqBimods โ (T Mโ โโ T Mโ) โแตฅ ฮฑโ โโจ assocโ โฉ
      actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ Coequalizer.arr CoeqBimods โ (T Mโ โโ T Mโ) โแตฅ ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionหก-โ โแตฅ ((F-โ โท ฮผ Mโ) โแตฅ Coequalizer.arr CoeqBimods โ (T Mโ โโ T Mโ)) โแตฅ ฮฑโ โโจ reflโฉโโจ โ-โท-exchg โฉโโจrefl โฉ
      actionหก-โ โแตฅ (Coequalizer.arr CoeqBimods โ T Mโ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ) โแตฅ ฮฑโ โโจ reflโฉโโจ assocโ โฉ
      actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ) โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ โบ actionหกSq-โ โฉโโจrefl โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ) โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ assocโ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮผ Mโ โแตฅ ฮฑโ โโจ reflโฉโโจ assoc-actionหก-โ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionหก-โ โแตฅ actionหก-โ โ T Mโ โโจ โบ assocโ โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ) โแตฅ actionหก-โ โ T Mโ โโจ actionหกSq-โ โฉโโจrefl โฉ
      (actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ) โแตฅ actionหก-โ โ T Mโ โโจ assocโ โฉ
      actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ โแตฅ actionหก-โ โ T Mโ โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ) โ T Mโ โโจ reflโฉโโจ โ-resp-โ actionหกSq-โ โฉ
      actionหก-โ โแตฅ (actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ) โ T Mโ โโจ reflโฉโโจ โบ โแตฅ-distr-โ โฉ
      actionหก-โ โแตฅ (actionหก-โ โ T Mโ) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ) โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ (actionหก-โ โ T Mโ)) โแตฅ Coequalizer.arr ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ) โ
      where
        open hom.HomReasoning

  abstract
    assoc-actionหก-โ : actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ ฮฑโ โ actionหก-โ โแตฅ (actionหก-โ โ T Mโ)
    assoc-actionหก-โ = CoequalizerโEpi
                        ((CoeqBimods coeq-โ T Mโ) coeq-โ T Mโ)
                        (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ ฮฑโ)
                        (actionหก-โ โแตฅ (actionหก-โ โ T Mโ))
                        assoc-actionหก-โ-โarr

  abstract
    assoc-actionหก-โ-var : (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)) โแตฅ ฮฑโ โ actionหก-โ โแตฅ (actionหก-โ โ T Mโ)
    assoc-actionหก-โ-var = begin
      (actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)) โแตฅ ฮฑโ โโจ assocโ โฉ
      actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โแตฅ ฮฑโ โโจ assoc-actionหก-โ โฉ
      actionหก-โ โแตฅ (actionหก-โ โ T Mโ) โ
      where
        open hom.HomReasoning

  abstract
    sym-assoc-actionหก-โ : actionหก-โ โแตฅ (actionหก-โ โ T Mโ) โแตฅ ฮฑโ โ actionหก-โ โแตฅ (F-โ โท ฮผ Mโ)
    sym-assoc-actionหก-โ = begin
      actionหก-โ โแตฅ (actionหก-โ โ T Mโ) โแตฅ ฮฑโ โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ (actionหก-โ โ T Mโ)) โแตฅ ฮฑโ โโจ โบ (switch-fromtoสณ associator assoc-actionหก-โ-var) โฉ
      actionหก-โ โแตฅ (F-โ โท ฮผ Mโ) โ
      where
        open hom.HomReasoning
        open IsoReasoning using (switch-fromtoสณ)
  -- end abstract --

  abstract
    assoc-actionสณ-โ : actionสณ-โ โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โ actionสณ-โ โแตฅ T Mโ โท actionสณ-โ
    assoc-actionสณ-โ = begin
      actionสณ-โ โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ)) โแตฅ ฮฑโ โโจ reflโฉโโจ ฮฑโ-โ-โโ โฉโโจrefl โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮผ Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ ฮฑโ โโจ reflโฉโโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮผ Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮฑโ โโจ reflโฉโโจ reflโฉโโจ โบ pentagon-inv โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮผ Mโ โ F Bโ โ F Bโ โแตฅ (ฮฑโ โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ reflโฉโโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮผ Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮผ Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ โ F Bโ) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ โบ assocโ โฉ
      (actionสณ Bโ โ F Bโ โแตฅ ฮผ Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ โ F Bโ) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ (reflโฉโโจ โแตฅ-distr-โ) โฉโโจrefl โฉ
      (actionสณ Bโ โ F Bโ โแตฅ (ฮผ Mโ โ F Bโ โแตฅ ฮฑโ) โ F Bโ) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ โแตฅ-distr-โ โฉโโจrefl โฉ
      (actionสณ Bโ โแตฅ ฮผ Mโ โ F Bโ โแตฅ ฮฑโ) โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ โ-resp-โ (assoc-actionสณ Bโ) โฉโโจrefl โฉ
      (actionสณ Bโ โแตฅ T Mโ โท actionสณ Bโ) โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ โบ โแตฅ-distr-โ โฉโโจrefl โฉ
      (actionสณ Bโ โ F Bโ โแตฅ (T Mโ โท actionสณ Bโ) โ F Bโ) โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (T Mโ โท actionสณ Bโ) โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ((T Mโ โท actionสณ Bโ) โ F Bโ โแตฅ ฮฑโ) โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ โบ ฮฑโ-โท-โ โฉโโจrefl โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ T Mโ โท (actionสณ Bโ โ F Bโ)) โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ T Mโ โท (actionสณ Bโ โ F Bโ) โแตฅ T Mโ โท ฮฑโ โโจ โบ assocโ โฉ
      actionสณ-โ โแตฅ T Mโ โท (actionสณ Bโ โ F Bโ) โแตฅ T Mโ โท ฮฑโ โโจ reflโฉโโจ โแตฅ-distr-โท โฉ
      actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โ
      where
        open hom.HomReasoning

  abstract
    assoc-actionสณ-โ-โarr : (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ ฮฑโ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods))
                         โ (actionสณ-โ โแตฅ T Mโ โท actionสณ-โ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods))
    assoc-actionสณ-โ-โarr = begin
      (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ ฮฑโ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods)) โโจ โบ assocโ โฉโโจrefl โฉ
      ((actionสณ-โ โแตฅ ฮผ Mโ โ F-โ) โแตฅ ฮฑโ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods)) โโจ assocโ โฉ
      (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ) โแตฅ ฮฑโ โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods)) โโจ reflโฉโโจ ฮฑโ-โท-โโ โฉ
      (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ) โแตฅ (T Mโ โโ T Mโ) โท Coequalizer.arr CoeqBimods โแตฅ ฮฑโ โโจ assocโ โฉ
      actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ (T Mโ โโ T Mโ) โท Coequalizer.arr CoeqBimods โแตฅ ฮฑโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ-โ โแตฅ (ฮผ Mโ โ F-โ โแตฅ (T Mโ โโ T Mโ) โท Coequalizer.arr CoeqBimods) โแตฅ ฮฑโ โโจ reflโฉโโจ โบ โ-โท-exchg โฉโโจrefl โฉ
      actionสณ-โ โแตฅ (T Mโ โท Coequalizer.arr CoeqBimods โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ)) โแตฅ ฮฑโ โโจ reflโฉโโจ assocโ โฉ
      actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ โบ assocโ โฉ
      (actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods) โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ โบ actionสณSq-โ โฉโโจrefl โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ assocโ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ โแตฅ ฮผ Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮฑโ โโจ reflโฉโโจ assoc-actionสณ-โ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โโจ โบ assocโ โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โแตฅ T Mโ โท actionสณ-โ โโจ actionสณSq-โ โฉโโจrefl โฉ
      (actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods) โแตฅ T Mโ โท actionสณ-โ โโจ assocโ โฉ
      actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods โแตฅ T Mโ โท actionสณ-โ โโจ reflโฉโโจ โแตฅ-distr-โท โฉ
      actionสณ-โ โแตฅ T Mโ โท (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โโจ reflโฉโโจ โท-resp-โ actionสณSq-โ โฉ
      actionสณ-โ โแตฅ T Mโ โท (actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods) โโจ reflโฉโโจ โบ โแตฅ-distr-โท โฉ
      actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods)) โโจ โบ assocโ โฉ
      (actionสณ-โ โแตฅ T Mโ โท actionสณ-โ) โแตฅ Coequalizer.arr (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods)) โ
      where
        open hom.HomReasoning

  abstract
    assoc-actionสณ-โ : actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ ฮฑโ โ actionสณ-โ โแตฅ T Mโ โท actionสณ-โ
    assoc-actionสณ-โ = CoequalizerโEpi
                        (T Mโ โท-coeq (T Mโ โท-coeq CoeqBimods))
                        (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ ฮฑโ)
                        (actionสณ-โ โแตฅ T Mโ โท actionสณ-โ)
                        assoc-actionสณ-โ-โarr
  abstract
    assoc-actionสณ-โ-var : (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ) โแตฅ ฮฑโ โ actionสณ-โ โแตฅ T Mโ โท actionสณ-โ
    assoc-actionสณ-โ-var = begin
      (actionสณ-โ โแตฅ ฮผ Mโ โ F-โ) โแตฅ ฮฑโ โโจ assocโ โฉ
      actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โแตฅ ฮฑโ โโจ assoc-actionสณ-โ โฉ
      actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โ
      where
        open hom.HomReasoning
  abstract
    sym-assoc-actionสณ-โ : actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โแตฅ ฮฑโ โ actionสณ-โ โแตฅ ฮผ Mโ โ F-โ
    sym-assoc-actionสณ-โ = begin
      actionสณ-โ โแตฅ T Mโ โท actionสณ-โ โแตฅ ฮฑโ โโจ โบ assocโ โฉ
      (actionสณ-โ โแตฅ T Mโ โท actionสณ-โ) โแตฅ ฮฑโ โโจ โบ (switch-tofromสณ associator assoc-actionสณ-โ-var) โฉ
      actionสณ-โ โแตฅ ฮผ Mโ โ F-โ โ
      where
        open hom.HomReasoning
        open IsoReasoning using (switch-tofromสณ)
  -- end abstract --

module Identity where
  open Left-Action using (actionหก-โ; actionหกSq-โ; actionหก-โ)
  open Right-Action using (actionสณ-โ; actionสณSq-โ; actionสณ-โ)

  abstract
    identityหก-โ : actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โ idโ
    identityหก-โ = begin
      actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ ฮฑโ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ reflโฉโโจ โบ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ (ฮฑโ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ) โแตฅ ฯโ โโจ reflโฉโโจ ฮฑโ-โท-โโ โฉโโจrefl โฉ
      F Bโ โท actionหก Bโ โแตฅ (F Bโ โท F Bโ โท ฮท Mโ โแตฅ ฮฑโ) โแตฅ ฯโ โโจ reflโฉโโจ assocโ โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮท Mโ โแตฅ ฮฑโ โแตฅ ฯโ โโจ (reflโฉโโจ reflโฉโโจ โบ unitorสณ-coherence-varโ) โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท F Bโ โท ฮท Mโ โแตฅ F Bโ โท ฯโ โโจ reflโฉโโจ โแตฅ-distr-โท โฉ
      F Bโ โท actionหก Bโ โแตฅ F Bโ โท (F Bโ โท ฮท Mโ โแตฅ ฯโ) โโจ โแตฅ-distr-โท โฉ
      F Bโ โท (actionหก Bโ โแตฅ F Bโ โท ฮท Mโ โแตฅ ฯโ) โโจ โท-resp-โ (identityหก Bโ) โฉ
      F Bโ โท idโ โโจ โทidโ โฉ
      idโ โ
      where
        open hom.HomReasoning

  abstract
    identityหก-โ-โarr : (actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ ฯโ) โแตฅ Coequalizer.arr CoeqBimods โ idโ โแตฅ Coequalizer.arr CoeqBimods
    identityหก-โ-โarr = begin
      (actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ ฯโ) โแตฅ Coequalizer.arr CoeqBimods โโจ assocโ โฉ
      actionหก-โ โแตฅ (F-โ โท ฮท Mโ โแตฅ ฯโ) โแตฅ Coequalizer.arr CoeqBimods โโจ reflโฉโโจ assocโ โฉ
      actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ ฯโ โแตฅ Coequalizer.arr CoeqBimods โโจ reflโฉโโจ reflโฉโโจ โบ โ-โแตฅ-ฯโ โฉ
      actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ Coequalizer.arr CoeqBimods โ idโ โแตฅ ฯโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionหก-โ โแตฅ (F-โ โท ฮท Mโ โแตฅ Coequalizer.arr CoeqBimods โ idโ) โแตฅ ฯโ โโจ reflโฉโโจ โ-โท-exchg โฉโโจrefl โฉ
      actionหก-โ โแตฅ (Coequalizer.arr CoeqBimods โ T Mโ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ) โแตฅ ฯโ โโจ reflโฉโโจ assocโ โฉ
      actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ โบ assocโ โฉ
      (actionหก-โ โแตฅ Coequalizer.arr CoeqBimods โ T Mโ) โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ โบ actionหกSq-โ โฉโโจrefl โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionหก-โ) โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ assocโ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionหก-โ โแตฅ (F Bโ โโ F Bโ) โท ฮท Mโ โแตฅ ฯโ โโจ reflโฉโโจ identityหก-โ โฉ
      Coequalizer.arr CoeqBimods โแตฅ idโ โโจ identityโสณ โฉ
      Coequalizer.arr CoeqBimods โโจ โบ identityโหก โฉ
      idโ โแตฅ Coequalizer.arr CoeqBimods โ
      where
        open hom.HomReasoning

  abstract
    identityหก-โ : actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ ฯโ โ idโ
    identityหก-โ = CoequalizerโEpi
                    CoeqBimods
                    (actionหก-โ โแตฅ F-โ โท ฮท Mโ โแตฅ ฯโ)
                    idโ
                    identityหก-โ-โarr

  abstract
    identityสณ-โ : actionสณ-โ โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โ idโ
    identityสณ-โ = begin
      actionสณ-โ โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮฑโ โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ)) โแตฅ ฮปโ โโจ reflโฉโโจ ฮฑโ-โ-โโ โฉโโจrefl โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮท Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ) โแตฅ ฮปโ โโจ reflโฉโโจ assocโ โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮท Mโ โ F Bโ โ F Bโ โแตฅ ฮฑโ โแตฅ ฮปโ โโจ reflโฉโโจ reflโฉโโจ โบ unitorหก-coherence-inv โฉ
      actionสณ Bโ โ F Bโ โแตฅ ฮท Mโ โ F Bโ โ F Bโ โแตฅ ฮปโ โ F Bโ โโจ reflโฉโโจ โแตฅ-distr-โ โฉ
      actionสณ Bโ โ F Bโ โแตฅ (ฮท Mโ โ F Bโ โแตฅ ฮปโ) โ F Bโ โโจ โแตฅ-distr-โ โฉ
      (actionสณ Bโ โแตฅ ฮท Mโ โ F Bโ โแตฅ ฮปโ) โ F Bโ โโจ โ-resp-โ (identityสณ Bโ) โฉ
      idโ โ F Bโ โโจ idโโ โฉ
      idโ โ
      where
        open hom.HomReasoning

  abstract
    identityสณ-โ-โarr : (actionสณ-โ โแตฅ ฮท Mโ โ F-โ โแตฅ ฮปโ) โแตฅ Coequalizer.arr CoeqBimods โ idโ โแตฅ Coequalizer.arr CoeqBimods
    identityสณ-โ-โarr = begin
      (actionสณ-โ โแตฅ ฮท Mโ โ F-โ โแตฅ ฮปโ) โแตฅ Coequalizer.arr CoeqBimods โโจ assocโ โฉ
      actionสณ-โ โแตฅ (ฮท Mโ โ F-โ โแตฅ ฮปโ) โแตฅ Coequalizer.arr CoeqBimods โโจ reflโฉโโจ assocโ โฉ
      actionสณ-โ โแตฅ ฮท Mโ โ F-โ โแตฅ ฮปโ โแตฅ Coequalizer.arr CoeqBimods โโจ reflโฉโโจ reflโฉโโจ โบ โท-โแตฅ-ฮปโ โฉ
      actionสณ-โ โแตฅ ฮท Mโ โ F-โ โแตฅ idโ โท Coequalizer.arr CoeqBimods โแตฅ ฮปโ โโจ reflโฉโโจ โบ assocโ โฉ
      actionสณ-โ โแตฅ (ฮท Mโ โ F-โ โแตฅ idโ โท Coequalizer.arr CoeqBimods) โแตฅ ฮปโ โโจ reflโฉโโจ โบ โ-โท-exchg โฉโโจrefl โฉ
      actionสณ-โ โแตฅ (T Mโ โท Coequalizer.arr CoeqBimods โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ)) โแตฅ ฮปโ โโจ reflโฉโโจ assocโ โฉ
      actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ โบ assocโ โฉ
      (actionสณ-โ โแตฅ T Mโ โท Coequalizer.arr CoeqBimods) โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ โบ actionสณSq-โ โฉโโจrefl โฉ
      (Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ) โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ assocโ โฉ
      Coequalizer.arr CoeqBimods โแตฅ actionสณ-โ โแตฅ ฮท Mโ โ (F Bโ โโ F Bโ) โแตฅ ฮปโ โโจ reflโฉโโจ identityสณ-โ โฉ
      Coequalizer.arr CoeqBimods โแตฅ idโ โโจ identityโสณ โฉ
      Coequalizer.arr CoeqBimods โโจ โบ identityโหก โฉ
      idโ โแตฅ Coequalizer.arr CoeqBimods โ
      where
        open hom.HomReasoning

  abstract
    identityสณ-โ : actionสณ-โ โแตฅ (ฮท Mโ โ F-โ) โแตฅ ฮปโ โ idโ
    identityสณ-โ = CoequalizerโEpi
                    CoeqBimods
                    (actionสณ-โ โแตฅ (ฮท Mโ โ F-โ) โแตฅ ฮปโ)
                    idโ
                    identityสณ-โ-โarr
  -- end abstract --


Tensorproduct : Bimodule Mโ Mโ
Tensorproduct = record
  { F = F-โ
  ; actionหก = Left-Action.actionหก-โ                       -- : F โโ T Mโ โโ F
  ; actionสณ = Right-Action.actionสณ-โ                      -- : T Mโ โโ F โโ F
  ; assoc = Associativity.assoc-โ                         -- : actionสณ โแตฅ (T Mโ โท actionหก) โแตฅ ฮฑโ โ actionหก โแตฅ (actionสณ โ T Mโ)
  ; sym-assoc = Associativity.sym-assoc-โ                 -- : actionหก โแตฅ (actionสณ โ T Mโ)โแตฅ ฮฑโ โ actionสณ โแตฅ (T Mโ โท actionหก)
  ; assoc-actionหก = Associativity.assoc-actionหก-โ         -- : actionหก โแตฅ (F โท ฮผ Mโ) โแตฅ ฮฑโ โ actionหก โแตฅ (actionหก โ T Mโ)
  ; sym-assoc-actionหก = Associativity.sym-assoc-actionหก-โ -- : actionหก โแตฅ (actionหก โ T Mโ) โแตฅ ฮฑโ โ actionหก โแตฅ (F โท ฮผ Mโ)
  ; assoc-actionสณ = Associativity.assoc-actionสณ-โ         -- : actionสณ โแตฅ (ฮผ Mโ โ F) โแตฅ ฮฑโ โ actionสณ โแตฅ (T Mโ โท actionสณ)
  ; sym-assoc-actionสณ = Associativity.sym-assoc-actionสณ-โ -- : actionสณ โแตฅ (T Mโ โท actionสณ) โแตฅ ฮฑโ โ actionสณ โแตฅ (ฮผ Mโ โ F)
  ; identityหก = Identity.identityหก-โ                      -- : actionหก โแตฅ (F โท ฮท Mโ) โแตฅ ฯโ โ idโ
  ; identityสณ = Identity.identityสณ-โ                      -- : actionสณ โแตฅ (ฮท Mโ โ F) โแตฅ ฮปโ โ idโ
  }
